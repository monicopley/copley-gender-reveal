<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Welcome to Our Gender Reveal!</title>
  <style>
    /* Page-wide styling */
    body {
      background-color: #f0f8ff; /* Very light blue, almost white */
      margin: 0;
      padding: 0;
      text-align: center;
      font-family: sans-serif;
    }

    /* Main headings */
    h1 {
      color: pink;             /* Header color changed to pink */
      font-size: 3rem;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }
    h2 {
      color: #555555;         /* Dark gray subheader */
      font-size: 1.5rem;
      margin-bottom: 2rem;
    }

    /* Scratch card container */
    #scratchCardContainer {
      margin: 0 auto;
      position: relative;
      width: 300px;
      height: 300px;
      border: 2px solid #000;
    }

    /* Underlying canvas: displays background + reveal text */
    #underCanvas {
      position: relative;
      z-index: 1;
    }

    /* Overlay canvas: the scratchable lightgrey layer with big number */
    #overlayCanvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      cursor: crosshair;
    }

    /* Countdown text styling - larger than before */
    .countdown {
      font-size: 6rem;
      color: red;
      display: none;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <!-- Page Titles -->
  <h1>Welcome to Our Gender Reveal!</h1>
  <h2>Scratch the card to reveal the surprise!</h2>

  <!-- Scratch Card Container -->
  <div id="scratchCardContainer">
    <canvas id="underCanvas" width="300" height="300"></canvas>
    <canvas id="overlayCanvas" width="300" height="300"></canvas>
  </div>

  <!-- Countdown Display -->
  <div class="countdown" id="countdown"></div>

  <!-- Trumpet sound (ensure trumpet.mp3 is in the same folder) -->
  <audio id="trumpetSound" src="trumpet.mp3"></audio>

  <!-- Confetti library from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>

  <script>
    /*
      This code implements a 3-card interactive gender reveal.
      - Card #3: Grey overlay with the number "3". Once 70% is scratched, underneath displays "What am I?" in gold.
      - Card #2: Grey overlay with the number "2". For this card, we now require 80% clearance (to avoid premature clearing), and the underneath reveals "Wait for it..." (gold with light blue ellipses).
      - Card #1: Grey overlay with the number "1". Once scratched, reveals "I'm a GIRL!" in pink.
      After each card clears, a 3-2-1 countdown is shown (with 6rem countdown numbers). When the final card is done, confetti is launched and the trumpet sound plays.
      The scratch cursor (line-based erasure) is sized with a line width of 50.
      A flag (cardCleared) ensures each card is processed only once.
    */

    // Define states for the three cards.
    const states = [
      {
        numberText: "3",
        revealText: "What am I?",
        revealColor: "gold"
      },
      {
        numberText: "2",
        revealText: "Wait for it",
        ellipsesText: "...",
        revealColor: "gold",
        ellipsesColor: "lightblue"
      },
      {
        numberText: "1",
        revealText: "I'm a GIRL!",
        revealColor: "pink"
      }
    ];

    // DOM elements & context
    const underCanvas = document.getElementById("underCanvas");
    const underCtx = underCanvas.getContext("2d");
    const overlayCanvas = document.getElementById("overlayCanvas");
    const overlayCtx = overlayCanvas.getContext("2d");
    const countdownEl = document.getElementById
